{"version":3,"sources":["../../../src/lib/loader-utils/check-errors.ts"],"names":["checkFetchResponseStatus","response","ok","errorMessage","status","statusText","text","getErrorText","error","Error","checkFetchResponseStatusSync","matches","match","slice"],"mappings":"AAAA,OAAO,eAAeA,wBAAf,CAAwCC,QAAxC,EAAkD;AACvD,MAAI,CAACA,QAAQ,CAACC,EAAd,EAAkB;AAChB,QAAIC,YAAY,GAAI,gBAAeF,QAAQ,CAACG,MAAO,IAAGH,QAAQ,CAACI,UAAW,EAA1E;;AACA,QAAI;AACF,YAAMC,IAAI,GAAG,MAAML,QAAQ,CAACK,IAAT,EAAnB;;AACA,UAAIA,IAAJ,EAAU;AACRH,QAAAA,YAAY,IAAK,KAAII,YAAY,CAACD,IAAD,CAAO,EAAxC;AACD;AACF,KALD,CAKE,OAAOE,KAAP,EAAc,CAEf;;AACD,UAAM,IAAIC,KAAJ,CAAUN,YAAV,CAAN;AACD;AACF;AAED,OAAO,SAASO,4BAAT,CAAsCT,QAAtC,EAAgD;AACrD,MAAI,CAACA,QAAQ,CAACC,EAAd,EAAkB;AAChB,UAAM,IAAIO,KAAJ,CAAW,gBAAeR,QAAQ,CAACG,MAAO,EAA1C,CAAN;AACD;AACF;;AAED,SAASG,YAAT,CAAsBD,IAAtB,EAA4B;AAE1B,QAAMK,OAAO,GAAGL,IAAI,CAACM,KAAL,CAAW,iBAAX,CAAhB;AACA,SAAOD,OAAO,GAAGA,OAAO,CAAC,CAAD,CAAV,GAAiB,IAAGL,IAAI,CAACO,KAAL,CAAW,CAAX,EAAc,EAAd,CAAkB,KAApD;AACD","sourcesContent":["export async function checkFetchResponseStatus(response) {\r\n  if (!response.ok) {\r\n    let errorMessage = `fetch failed ${response.status} ${response.statusText}`;\r\n    try {\r\n      const text = await response.text();\r\n      if (text) {\r\n        errorMessage += `: ${getErrorText(text)}`;\r\n      }\r\n    } catch (error) {\r\n      // ignore error\r\n    }\r\n    throw new Error(errorMessage);\r\n  }\r\n}\r\n\r\nexport function checkFetchResponseStatusSync(response) {\r\n  if (!response.ok) {\r\n    throw new Error(`fetch failed ${response.status}`);\r\n  }\r\n}\r\n\r\nfunction getErrorText(text) {\r\n  // Look for HTML error texts\r\n  const matches = text.match('<pre>(.*)</pre>');\r\n  return matches ? matches[1] : ` ${text.slice(0, 10)}...`;\r\n}\r\n"],"file":"check-errors.js"}