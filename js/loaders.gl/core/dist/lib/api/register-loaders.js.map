{"version":3,"sources":["../../../src/lib/api/register-loaders.ts"],"names":["normalizeLoader","getGlobalLoaderState","getGlobalLoaderRegistry","state","loaderRegistry","registerLoaders","loaders","Array","isArray","loader","normalizedLoader","find","registeredLoader","unshift","getRegisteredLoaders","_unregisterLoaders"],"mappings":"AACA,SAAQA,eAAR,QAA8B,kCAA9B;AACA,SAAQC,oBAAR,QAAmC,8BAAnC;;AAIA,MAAMC,uBAAuB,GAAG,MAAM;AACpC,QAAMC,KAAK,GAAGF,oBAAoB,EAAlC;AACAE,EAAAA,KAAK,CAACC,cAAN,GAAuBD,KAAK,CAACC,cAAN,IAAwB,EAA/C;AACA,SAAOD,KAAK,CAACC,cAAb;AACD,CAJD;;AAMA,OAAO,SAASC,eAAT,CAAyBC,OAAzB,EAA4C;AACjD,QAAMF,cAAc,GAAGF,uBAAuB,EAA9C;AAEAI,EAAAA,OAAO,GAAGC,KAAK,CAACC,OAAN,CAAcF,OAAd,IAAyBA,OAAzB,GAAmC,CAACA,OAAD,CAA7C;;AAEA,OAAK,MAAMG,MAAX,IAAqBH,OAArB,EAA8B;AAC5B,UAAMI,gBAAgB,GAAGV,eAAe,CAACS,MAAD,CAAxC;;AACA,QAAI,CAACL,cAAc,CAACO,IAAf,CAAqBC,gBAAD,IAAsBF,gBAAgB,KAAKE,gBAA/D,CAAL,EAAuF;AAErFR,MAAAA,cAAc,CAACS,OAAf,CAAuBH,gBAAvB;AACD;AACF;AACF;AAED,OAAO,SAASI,oBAAT,GAA0C;AAC/C,SAAOZ,uBAAuB,EAA9B;AACD;AAGD,OAAO,SAASa,kBAAT,GAA8B;AACnC,QAAMZ,KAAK,GAAGF,oBAAoB,EAAlC;AACAE,EAAAA,KAAK,CAACC,cAAN,GAAuB,EAAvB;AACD","sourcesContent":["import {Loader} from '@loaders.gl/loader-utils';\r\nimport {normalizeLoader} from '../loader-utils/normalize-loader';\r\nimport {getGlobalLoaderState} from '../loader-utils/option-utils';\r\n\r\n// Store global registered loaders on the global object to increase chances of cross loaders-version interoperability\r\n// This use case is not reliable but can help when testing new versions of loaders.gl with existing frameworks\r\nconst getGlobalLoaderRegistry = () => {\r\n  const state = getGlobalLoaderState();\r\n  state.loaderRegistry = state.loaderRegistry || [];\r\n  return state.loaderRegistry;\r\n};\r\n\r\nexport function registerLoaders(loaders: Loader[]) {\r\n  const loaderRegistry = getGlobalLoaderRegistry();\r\n\r\n  loaders = Array.isArray(loaders) ? loaders : [loaders];\r\n\r\n  for (const loader of loaders) {\r\n    const normalizedLoader = normalizeLoader(loader);\r\n    if (!loaderRegistry.find((registeredLoader) => normalizedLoader === registeredLoader)) {\r\n      // add to the beginning of the loaderRegistry, so the last registeredLoader get picked\r\n      loaderRegistry.unshift(normalizedLoader);\r\n    }\r\n  }\r\n}\r\n\r\nexport function getRegisteredLoaders(): Loader[] {\r\n  return getGlobalLoaderRegistry();\r\n}\r\n\r\n// For testing\r\nexport function _unregisterLoaders() {\r\n  const state = getGlobalLoaderState();\r\n  state.loaderRegistry = [];\r\n}\r\n"],"file":"register-loaders.js"}